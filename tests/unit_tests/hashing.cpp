#include <gtest/gtest.h>
#include <data/ByteSet.h>

TEST(HashingTest, keccak256)
{ 
    ByteSet<1> b1;
    ASSERT_EQ(b1.keccak256().asString(), "0xC5D2460186F7233C927E7DB2DCC703C0E500B653CA82273B7BFAD8045D85A470");
    ByteSet<4> b4;
    ASSERT_EQ(b4.keccak256().asString(), "0xC5D2460186F7233C927E7DB2DCC703C0E500B653CA82273B7BFAD8045D85A470");
    ByteSet<8> b8;
    ASSERT_EQ(b8.keccak256().asString(), "0xC5D2460186F7233C927E7DB2DCC703C0E500B653CA82273B7BFAD8045D85A470");

    b1 = ByteSet<1>("0xf9014b20b90147f90144b9014102f9013d01408501688c366f85138e343a0f83024e839411111112542d85b3ef69ae05771c2dccff4faa2688058d15e176280000b8c82e95b6c80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000058d15e17628000000000000000000000000000000000000000000000000000033ae2588e7a6d5f70000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000100000000000000003b6d034044c21f5dcb285d92320ae345c92e8b6204be8cdfe26b997780a0f6ca7e88883aa64a8bdff32392334cd209677c8afdfd1e739066534b6a91d2ada0470c867f5b0e26f0f9e8881ebce212da5cad6e45ab9d758a3d933e06b9ac7545");
    ASSERT_EQ(b1.keccak256().asString(), "0xA7A9E6E6BE9B2F9836461599F61874B7F84DFFE4C11DC9D3944D13FE4159FFA1");
    b4 = ByteSet<4>("0xf9014b20b90147f90144b9014102f9013d01408501688c366f85138e343a0f83024e839411111112542d85b3ef69ae05771c2dccff4faa2688058d15e176280000b8c82e95b6c80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000058d15e17628000000000000000000000000000000000000000000000000000033ae2588e7a6d5f70000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000100000000000000003b6d034044c21f5dcb285d92320ae345c92e8b6204be8cdfe26b997780a0f6ca7e88883aa64a8bdff32392334cd209677c8afdfd1e739066534b6a91d2ada0470c867f5b0e26f0f9e8881ebce212da5cad6e45ab9d758a3d933e06b9ac7545");
    ASSERT_EQ(b4.keccak256().asString(), "0xA7A9E6E6BE9B2F9836461599F61874B7F84DFFE4C11DC9D3944D13FE4159FFA1");
    b8 = ByteSet("0xf9014b20b90147f90144b9014102f9013d01408501688c366f85138e343a0f83024e839411111112542d85b3ef69ae05771c2dccff4faa2688058d15e176280000b8c82e95b6c80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000058d15e17628000000000000000000000000000000000000000000000000000033ae2588e7a6d5f70000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000100000000000000003b6d034044c21f5dcb285d92320ae345c92e8b6204be8cdfe26b997780a0f6ca7e88883aa64a8bdff32392334cd209677c8afdfd1e739066534b6a91d2ada0470c867f5b0e26f0f9e8881ebce212da5cad6e45ab9d758a3d933e06b9ac7545");
    ASSERT_EQ(b8.keccak256().asString(), "0xA7A9E6E6BE9B2F9836461599F61874B7F84DFFE4C11DC9D3944D13FE4159FFA1");
}

TEST(HashingTest, sha256)
{ 
    ByteSet<1> b1;
    ASSERT_EQ(b1.sha256().asString(), "0xE3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855");
    ByteSet<4> b4;
    ASSERT_EQ(b4.sha256().asString(), "0xE3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855");
    ByteSet<8> b8;
    ASSERT_EQ(b8.sha256().asString(), "0xE3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855");

    b1 = ByteSet<1>("0xf9014b20b90147f90144b9014102f9013d01408501688c366f85138e343a0f83024e839411111112542d85b3ef69ae05771c2dccff4faa2688058d15e176280000b8c82e95b6c80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000058d15e17628000000000000000000000000000000000000000000000000000033ae2588e7a6d5f70000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000100000000000000003b6d034044c21f5dcb285d92320ae345c92e8b6204be8cdfe26b997780a0f6ca7e88883aa64a8bdff32392334cd209677c8afdfd1e739066534b6a91d2ada0470c867f5b0e26f0f9e8881ebce212da5cad6e45ab9d758a3d933e06b9ac7545");
    ASSERT_EQ(b1.sha256().asString(), "0xEF94A1C5CBFF208666C897847E7A663F0AEF32AA1C20292C0C7BB420202184F7");
    b4 = ByteSet<4>("0xf9014b20b90147f90144b9014102f9013d01408501688c366f85138e343a0f83024e839411111112542d85b3ef69ae05771c2dccff4faa2688058d15e176280000b8c82e95b6c80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000058d15e17628000000000000000000000000000000000000000000000000000033ae2588e7a6d5f70000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000100000000000000003b6d034044c21f5dcb285d92320ae345c92e8b6204be8cdfe26b997780a0f6ca7e88883aa64a8bdff32392334cd209677c8afdfd1e739066534b6a91d2ada0470c867f5b0e26f0f9e8881ebce212da5cad6e45ab9d758a3d933e06b9ac7545");
    ASSERT_EQ(b4.sha256().asString(), "0xEF94A1C5CBFF208666C897847E7A663F0AEF32AA1C20292C0C7BB420202184F7");
    b8 = ByteSet("0xf9014b20b90147f90144b9014102f9013d01408501688c366f85138e343a0f83024e839411111112542d85b3ef69ae05771c2dccff4faa2688058d15e176280000b8c82e95b6c80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000058d15e17628000000000000000000000000000000000000000000000000000033ae2588e7a6d5f70000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000100000000000000003b6d034044c21f5dcb285d92320ae345c92e8b6204be8cdfe26b997780a0f6ca7e88883aa64a8bdff32392334cd209677c8afdfd1e739066534b6a91d2ada0470c867f5b0e26f0f9e8881ebce212da5cad6e45ab9d758a3d933e06b9ac7545");
    ASSERT_EQ(b8.sha256().asString(), "0xEF94A1C5CBFF208666C897847E7A663F0AEF32AA1C20292C0C7BB420202184F7");
}