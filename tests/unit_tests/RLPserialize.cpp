#include <gtest/gtest.h>
#include <data/ByteSet.h>

TEST(RLPSerializeTest, empty)
{
    ByteSet<1> b1;
    b1.RLPserialize(false);
    ASSERT_EQ(b1, ByteSet<1>(0x80, 8));
    b1.clear();
    b1.RLPserialize(true);
    ASSERT_EQ(b1, ByteSet<1>(0xC0, 8));

    ByteSet<4> b4;
    b4.RLPserialize(false);
    ASSERT_EQ(b4, ByteSet<4>(0x80, 2));
    b4.clear();
    b4.RLPserialize(true);
    ASSERT_EQ(b4, ByteSet<4>(0xC0, 2));

    ByteSet<8> b8;
    b8.RLPserialize(false);
    ASSERT_EQ(b8, ByteSet<8>(0x80, 1));
    b8.clear();
    b8.RLPserialize(true);
    ASSERT_EQ(b8, ByteSet<8>(0xC0, 1));
}

TEST(RLPSerializeTest, zero)
{
    ByteSet<1> b1(0);
    b1.RLPserialize(false);
    ASSERT_EQ(b1, ByteSet<1>(0x00, 8));
    b1 = 0;
    b1.RLPserialize(true);
    ASSERT_EQ(b1, ByteSet<1>(0xC100, 16));

    ByteSet<4> b4(0);
    b4.RLPserialize(false);
    ASSERT_EQ(b4, ByteSet<4>(0x00, 2));
    b4 = 0;
    b4.RLPserialize(true);
    ASSERT_EQ(b4, ByteSet<4>(0xC100, 4));

    ByteSet<8> b8(0);
    b8.RLPserialize(false);
    ASSERT_EQ(b8, ByteSet<8>(0x00, 1));
    b8 = 0;
    b8.RLPserialize(true);
    ASSERT_EQ(b8, ByteSet<8>(0xC100, 2));
}

TEST(RLPSerializeTest, own_rlp)
{
    //----------- LOW BOUNDARY -------------

    ByteSet<1> b1(1);
    b1.RLPserialize(false);
    ASSERT_EQ(b1, ByteSet<1>(0x01, 8));
    b1 = 1;
    b1.RLPserialize(true);
    ASSERT_EQ(b1, ByteSet<1>(0xC101, 16));

    ByteSet<4> b4(1);
    b4.RLPserialize(false);
    ASSERT_EQ(b4, ByteSet<4>(0x01, 2));
    b4 = 1;
    b4.RLPserialize(true);
    ASSERT_EQ(b4, ByteSet<4>(0xC101, 4));

    ByteSet<8> b8(1);
    b8.RLPserialize(false);
    ASSERT_EQ(b8, ByteSet<8>(0x01, 1));
    b8 = 1;
    b8.RLPserialize(true);
    ASSERT_EQ(b8, ByteSet<8>(0xC101, 2));

    //----------- HIGH BOUNDARY -------------

    b1 = 0x7F;
    b1.RLPserialize(false);
    ASSERT_EQ(b1, ByteSet<1>(0x7F, 8));
    b1 = 0x7F;
    b1.RLPserialize(true);
    ASSERT_EQ(b1, ByteSet<1>(0xC17F, 16));

    b4 = 0x7F;
    b4.RLPserialize(false);
    ASSERT_EQ(b4, ByteSet<4>(0x7F, 2));
    b4 = 0x7F;
    b4.RLPserialize(true);
    ASSERT_EQ(b4, ByteSet<4>(0xC17F, 4));

    b8 = 0x7F;
    b8.RLPserialize(false);
    ASSERT_EQ(b8, ByteSet<8>(0x7F, 1));
    b8 = 0x7F;
    b8.RLPserialize(true);
    ASSERT_EQ(b8, ByteSet<8>(0xC17F, 2));
}

TEST(RLPSerializeTest, x80_xC0_rlp)
{
    //----------- LOW BOUNDARY -------------

    ByteSet<1> b1(0x80);
    b1.RLPserialize(false);
    ASSERT_EQ(b1, ByteSet<1>(0x8180, 16));
    b1 = 0x80;
    b1.RLPserialize(true);
    ASSERT_EQ(b1, ByteSet<1>(0xC180, 16));

    ByteSet<4> b4(0x80);
    b4.RLPserialize(false);
    ASSERT_EQ(b4, ByteSet<4>(0x8180, 4));
    b4 = 0x80;
    b4.RLPserialize(true);
    ASSERT_EQ(b4, ByteSet<4>(0xC180, 4));

    ByteSet<8> b8(0x80);
    b8.RLPserialize(false);
    ASSERT_EQ(b8, ByteSet<8>(0x8180, 2));
    b8 = 0x80;
    b8.RLPserialize(true);
    ASSERT_EQ(b8, ByteSet<8>(0xC180, 2));
    
    //----------- HIGH BOUNDARY -------------
    
    b1 = ByteSet<1>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    b1.RLPserialize(false);
    ASSERT_EQ(b1, ByteSet<1>("0xB7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
    b1 = ByteSet<1>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    b1.RLPserialize(true);
    ASSERT_EQ(b1, ByteSet<1>("0xF7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));

    b4 = ByteSet<4>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    b4.RLPserialize(false);
    ASSERT_EQ(b4, ByteSet<4>("0xB7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
    b4 = ByteSet<4>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    b4.RLPserialize(true);
    ASSERT_EQ(b4, ByteSet<4>("0xF7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));

    b8 = ByteSet<8>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    b8.RLPserialize(false);
    ASSERT_EQ(b8, ByteSet<8>("0xB7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
    b8 = ByteSet<8>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    b8.RLPserialize(true);
    ASSERT_EQ(b8, ByteSet<8>("0xF7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));

}

TEST(RLPSerializeTest, xB7_xF7_rlp)
{
    //----------- LOW BOUNDARY -------------
    
    ByteSet<1> b1("0x0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex);
    b1.RLPserialize(false);
    ASSERT_EQ(b1, ByteSet<1>("0xB8380100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex));
    b1 = ByteSet<1>("0x0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex);
    b1.RLPserialize(true);
    ASSERT_EQ(b1, ByteSet<1>("0xF8380100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex));


    ByteSet<4> b4("0x0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex);
    b4.RLPserialize(false);
    ASSERT_EQ(b4, ByteSet<4>("0xB8380100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex));
    b4 = ByteSet<4>("0x0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex);
    b4.RLPserialize(true);
    ASSERT_EQ(b4, ByteSet<4>("0xF8380100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex));

    ByteSet<8> b8("0x0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex);
    b8.RLPserialize(false);
    ASSERT_EQ(b8, ByteSet<8>("0xB8380100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex));
    b8 = ByteSet<8>("0x0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex);
    b8.RLPserialize(true);
    ASSERT_EQ(b8, ByteSet<8>("0xF8380100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex));


    //----------- HIGHER BOUNDARY (2 Bytes size_size) -------------

    b1 = ByteSet<1>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    b1.RLPserialize(false);
    ASSERT_EQ(b1, ByteSet<1>("0xB90100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
    b1 = ByteSet<1>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    b1.RLPserialize(true);
    ASSERT_EQ(b1, ByteSet<1>("0xF90100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));

    b4 = ByteSet<4>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    b4.RLPserialize(false);
    ASSERT_EQ(b4, ByteSet<4>("0xB90100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
    b4 = ByteSet<4>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    b4.RLPserialize(true);
    ASSERT_EQ(b4, ByteSet<4>("0xF90100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));

    b8 = ByteSet<8>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    b8.RLPserialize(false);
    ASSERT_EQ(b8, ByteSet<8>("0xB90100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
    b8 = ByteSet<8>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    b8.RLPserialize(true);
    ASSERT_EQ(b8, ByteSet<8>("0xF90100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));

}