#include <gtest/gtest.h>
#include <data/ByteSet.h>

TEST(RLPSerializeTest, empty)
{
    ByteSet<1> b1;
    ASSERT_EQ(b1.RLPserialize(), ByteSet<1>(0x80, 8));
    ASSERT_EQ(b1.RLPserialize(true), ByteSet<1>(0x80, 8));

    ByteSet<4> b4;
    ASSERT_EQ(b4.RLPserialize(), ByteSet<4>(0x80, 2));
    ASSERT_EQ(b4.RLPserialize(true), ByteSet<4>(0x80, 2));

    ByteSet<8> b8;
    ASSERT_EQ(b8.RLPserialize(), ByteSet<8>(0x80, 1));
    ASSERT_EQ(b8.RLPserialize(true), ByteSet<8>(0x80, 1));
}

TEST(RLPSerializeTest, zero)
{
    ByteSet<1> b1(0);
    ASSERT_EQ(b1.RLPserialize(), ByteSet<1>(0x00, 8));
    b1 = ByteSet<1>("0x0000", Hex);
    ASSERT_EQ(b1.RLPserialize(true), ByteSet<1>(0x80, 8));

    ByteSet<4> b4(0);
    ASSERT_EQ(b4.RLPserialize(), ByteSet<4>(0x00, 2));
    b4 = ByteSet<4>("0x0000", Hex);
    ASSERT_EQ(b4.RLPserialize(true), ByteSet<4>(0x80, 2));

    ByteSet<8> b8(0);
    ASSERT_EQ(b8.RLPserialize(), ByteSet<8>(0x00, 1));
    b8 = ByteSet<8>("0x0000", Hex);
    ASSERT_EQ(b8.RLPserialize(true), ByteSet<8>(0x80, 1));
}

TEST(RLPSerializeTest, own_rlp)
{
    //----------- LOW BOUNDARY -------------

    ByteSet<1> b1(1);
    ASSERT_EQ(b1.RLPserialize(), ByteSet<1>(0x01, 8));
    b1 = ByteSet<1>("0x0001", Hex);
    ASSERT_EQ(b1.RLPserialize(true), ByteSet<1>(0x01, 8));

    ByteSet<4> b4(1);
    ASSERT_EQ(b4.RLPserialize(), ByteSet<4>(0x01, 2));
    b4 = ByteSet<4>("0x0001", Hex);
    ASSERT_EQ(b4.RLPserialize(true), ByteSet<4>(0x01, 2));

    ByteSet<8> b8(1);
    ASSERT_EQ(b8.RLPserialize(), ByteSet<8>(0x01, 1));
    b8 = ByteSet<8>("0x0001", Hex);
    ASSERT_EQ(b8.RLPserialize(true), ByteSet<8>(0x01, 1));

    //----------- HIGH BOUNDARY -------------

    b1 = 0x7f;
    ASSERT_EQ(b1.RLPserialize(), ByteSet<1>(0x7f, 8));
    b1 = ByteSet<1>("0x007f", Hex);
    ASSERT_EQ(b1.RLPserialize(true), ByteSet<1>(0x7f, 8));

    b4 = 0x7f;
    ASSERT_EQ(b4.RLPserialize(), ByteSet<4>(0x7f, 2));
    b4 = ByteSet<4>("0x007f", Hex);
    ASSERT_EQ(b4.RLPserialize(true), ByteSet<4>(0x7f, 2));

    b8 = 0x7f;
    ASSERT_EQ(b8.RLPserialize(), ByteSet<8>(0x7f, 1));
    b8 = ByteSet<8>("0x007f", Hex);
    ASSERT_EQ(b8.RLPserialize(true), ByteSet<8>(0x7f, 1));
}

TEST(RLPSerializeTest, x80_rlp)
{
    //----------- LOW BOUNDARY -------------

    ByteSet<1> b1(0x80);
    ASSERT_EQ(b1.RLPserialize(), ByteSet<1>(0x8180, 16));
    b1 = ByteSet<1>("0x0080", Hex);
    ASSERT_EQ(b1.RLPserialize(true), ByteSet<1>(0x8180, 16));

    ByteSet<4> b4(0x80);
    ASSERT_EQ(b4.RLPserialize(), ByteSet<4>(0x8180, 4));
    b4 = ByteSet<4>("0x0080", Hex);
    ASSERT_EQ(b4.RLPserialize(true), ByteSet<4>(0x8180, 4));

    ByteSet<8> b8(0x80);
    ASSERT_EQ(b8.RLPserialize(), ByteSet<8>(0x8180, 2));
    b8 = ByteSet<8>("0x0080", Hex);
    ASSERT_EQ(b8.RLPserialize(true), ByteSet<8>(0x8180, 2));
    
    //----------- HIGH BOUNDARY -------------
    
    b1 = ByteSet<1>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    ASSERT_EQ(b1.RLPserialize(), ByteSet<1>("0xb7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
    b1 = ByteSet<1>("0x00FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    ASSERT_EQ(b1.RLPserialize(true), ByteSet<1>("0xb7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));

    b4 = ByteSet<4>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    ASSERT_EQ(b4.RLPserialize(), ByteSet<4>("0xb7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
    b4 = ByteSet<4>("0x00FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    ASSERT_EQ(b4.RLPserialize(true), ByteSet<4>("0xb7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));

    b8 = ByteSet<8>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    ASSERT_EQ(b8.RLPserialize(), ByteSet<8>("0xb7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
    b8 = ByteSet<8>("0x00FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    ASSERT_EQ(b8.RLPserialize(true), ByteSet<8>("0xb7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
}

TEST(RLPSerializeTest, xb7_rlp)
{
    //----------- LOW BOUNDARY -------------
    
    ByteSet<1> b1("0x0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex);
    ASSERT_EQ(b1.RLPserialize(), ByteSet<1>("0xb8380100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex));
    b1 = ByteSet<1>("0x000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex);
    ASSERT_EQ(b1.RLPserialize(true), ByteSet<1>("0xb8380100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex));

    ByteSet<4> b4("0x0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex);
    ASSERT_EQ(b4.RLPserialize(), ByteSet<4>("0xb8380100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex));
    b4 = ByteSet<4>("0x000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex);
    ASSERT_EQ(b4.RLPserialize(true), ByteSet<4>("0xb8380100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex));

    ByteSet<8> b8("0x0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex);
    ASSERT_EQ(b8.RLPserialize(), ByteSet<8>("0xb8380100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex));
    b8 = ByteSet<8>("0x000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex);
    ASSERT_EQ(b8.RLPserialize(true), ByteSet<8>("0xb8380100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex));

    //----------- HIGHER BOUNDARY (2 Bytes size_size) -------------

    b1 = ByteSet<1>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    ASSERT_EQ(b1.RLPserialize(), ByteSet<1>("0xb90100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
    b1 = ByteSet<1>("0x00FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    ASSERT_EQ(b1.RLPserialize(true), ByteSet<1>("0xb90100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));

    b4 = ByteSet<4>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    ASSERT_EQ(b4.RLPserialize(), ByteSet<4>("0xb90100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
    b4 = ByteSet<4>("0x00FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    ASSERT_EQ(b4.RLPserialize(true), ByteSet<4>("0xb90100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));

    b8 = ByteSet<8>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    ASSERT_EQ(b8.RLPserialize(), ByteSet<8>("0xb90100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
    b8 = ByteSet<8>("0x00FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    ASSERT_EQ(b8.RLPserialize(true), ByteSet<8>("0xb90100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
}